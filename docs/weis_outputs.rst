WEIS Outputs
=============

File Structure & Location
--------------------------

The WEIS Outputs are determined by the way it configures ``analysis_options`` and ``modeling_options`` files.
The name and path of WEIS Output files are determined by the variable ``general/folder_output`` and ``general/fname_output`` from the ``analysis_options`` file.
Below is an example of file structure from WEIS Outputs with OpenFAST-based optimization.

::

   WEIS Outputs
        ├── problem_vars.yaml               # WEIS Output
        ├── refturb_output-analysis.yaml    # .
        ├── refturb_output-modeling.yaml    # .
        ├── refturb_output.yaml             # .
        ├── refturb_output.mat              # WISDEM Output
        ├── refturb_output.npz              # .
        ├── refturb_output.pkl              # .
        ├── refturb_output.xlsx             # .
        ├── refturb_output.csv              # .
        ├── case_matrix_combined.txt        # DLC
        ├── case_matrix_combined.yaml       # .
        ├── case_matrix_DLC1.6_0.txt        # .
        ├── case_matrix_DLC1.6_0.yaml       # .
        ├── log_opt.sql                     # Optimization
        └── openfast_runs/                  # OpenFAST related
                 ├── DLC1.6_0_AeroDyn_blade.dat             # OpenFAST Inputs
                 ├── DLC1.6_0_AeroDyn.dat                   # .
                 ├── DLC1.6_0_ElastoDyn_tower.dat           # .
                 ├── DLC1.6_0_ElastoDyn.dat                 # .
                 ├── DLC1.6_0_ElastoDynBlade.dat            # .
                 ├── DLC1.6_0_HydroDyn.dat                  # .
                 ├── DLC1.6_0_InflowWind.dat                # .
                 ├── DLC1.6_0_MoorDyn.dat                   # .
                 ├── DLC1.6_0_SeaState.dat                  # .
                 ├── DLC1.6_0_ServoDyn.dat                  # .
                 ├── Airfoils/                              # .
                 │      ├── DLC1.6_0_AeroDyn_Polar_00.dat
                 │      └── DLC1.6_0_AeroDyn_Polar_01.dat
                 ├── wind/                                  # . 
                 ├── DLC1.6_0.fst                           # OpenFAST Outputs   
                 ├── DLC1.6_0.out                           # .
                 ├── DLC1.6_0.outb                          # .
                 ├── DLC1.6_0.sum                           # .
                 │
                 ├── iteration_0/                           # Optimization
                 │      ├── DELs.p
                 │      ├── fst_vt.p
                 │      ├── summary_stats.p
                 │      └── timeseries/                     # OpenFAST Timeseries Output
                 │
                 └── iteration_1/                           # Optimization
                        ├── DELs.p
                        ├── fst_vt.p
                        ├── summary_stats.p
                        └── timeseries/                     # OpenFAST Timeseries Output
 


OpenFAST-related
-----------------

The OpenFAST-related files are located under ``openfast_runs/`` folder, containing the dynamic simulation output of Aero-servo-hydro-elastic modeling.
OpenFAST requires multiple input files to run the simulations, which will be automatically generated within WEIS.

    * *.fst
        * This is the main OpenFAST input file, which contains the references to all the other input files required for the simulation and specifies the simulation settings.
    
    * *.dat
        * These are typical data files that store specifies types of input parameters or configuration setting related to a particular subsystem of the wind turbine model.
          These files are used to provide additional information to OpenFAST, such as input parameters for aerodynamics, hydrodynamics, structural properties, control system, and environmental conditions.

    * Airfoils/*.dat
        * These input data files define the aerodynamic properties of the turbine blades' airfoils, which are crucial for simulating the aerodynamic forces acting on the turbine rotor in OpenFAST.

    * wind/*.in
        * The wind/ directory holds input data files for TurbSim that define the wind conditions for the simulation.


The output files generated by OpenFAST are typically time-series data and result files that contain detailed information on turbine performance, structural response, and environmental interactions.
These output files can be also in a variety of formats.

    * *.out
        * This is the main output file that contains time-series results from the simulation. It provides detailed data on turbine performance, including rotor speed, power output, blade deflection, aerodynamic loads, etc.
    
    * *.sum
        * This file contains a summary of the results at the end of the simulation. This includes key performance metrics such as total energy produced, maximum loads, and average power output over the simulation.


For more information, please refer to `OpenFAST <https://openfast.readthedocs.io/en/main/>`_ .


WISDEM/WEIS-related
--------------------

These are the general WEIS output files, integrated with OpenMDAO framework. These outputs provide a detailed and comprehensive view of a wind turbine's performance, including aerodynamics, structural integrity, dynamic response, and economic feasibility.
Various types of file extensions such as csv, mat, npz, pkl, and xlsx are supported, where basically all the contents are same.

refturb_output.yaml, refturb_output-analysis.yaml, and refturb_output-modeling.yaml files are the final version updated from the WEIS Input yaml files. (refturb_output is the name determined from ``analysis_options.yaml`` file.)

problem_vars.yaml file includes the content of design variables, constraints, and objectives.


DLC-related
------------
The case matrices for each DLC as well as combined version will be generated by WEIS. They are supported by yaml and text file formats. For more information, please refer to :doc:`Design Load Cases page <dlc_generator>`.


Optimization-related
------------------

The following files will be generated if optimization has been performed. This can be set up by enabling the optimization flag ``recorder/flag = True`` at ``analysis_options.yaml``.


    * OpenMDAO SQL Logs
        * The openmdao problem will be recorded as SQL database file if it was activated as a design variable or constraint. The filename will be the one that you defined under ``recorder/file_name``. This SQL log contains the full content of optimization, so this can be better used in understanding how the optimization has been converged over iterations.


For each iteration, various pcrunch data will be created:

    * timeseries/
        * This folder will be generated only if OpenFAST-based optimization has been performed. This contains OpenFAST time series outputs data.
    * summary_stats
        * This is a pcrunch data showing the statistics over channels across timeseries data. This supports ``min``, ``max``, ``std``, ``mean``, ``median``, ``abs``, and ``integrated``. This data can be coupled with case matrices to perform DLC Analysis.
    * DELs
        * 
    * fst_vt
        *

For RAFT-based optimization, ``raft/raft_designs/`` folder will be generated, containing RAFT time series outputs data, supported with both pickle and yaml file formats.
